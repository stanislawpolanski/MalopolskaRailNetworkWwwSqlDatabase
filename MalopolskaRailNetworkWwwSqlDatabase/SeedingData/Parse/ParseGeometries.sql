--declare @json nvarchar(max) = dbo.ReadGeometryJson();

--declare @table table
--(
--	GeometryType varchar(max),
--	Id int,
--	TextValue nvarchar(max)	,
--	Value sys.geometry
--);

--insert into @table (GeometryType, Id, TextValue)
--select * from
--	openjson(@json)
--with (
--	GeometryType varchar(max),
--	Id int N'$.Id',
--	TextValue nvarchar(max)  N'$.Value')

--update @table 
--	set Value = geometry::Parse('LINESTRING(658155.276 205175.418,658153.997 205174.037,658110.867 205126.304,658079.064 205096.168,658037.346 205058.956,658037.136 205058.769,657989.507 205016.336,657971.928 204994.155,657957.747 204974.491,657942.013 204946.621,657909.718 204882.47,657874.524 204815.188,657839.641 204746.871,657813.453 204695.323,657770.768 204612.553,657770.522 204612.075,657765.786 204603.354,657721.484 204515.888,657698.712 204471.792,657679.562 204434.425,657667.451 204409.065,657655.858 204379.771,657646.749 204349.753,657641.47 204327.912,657617.07 204213.734,657616.938 204213.119,657595.097 204109.505,657575.2 204015.551,657575.138 204015.313,657567.978 203987.622,657560.266 203962.21,657546.032 203926.192,657515.394 203852.903,657491.011 203796.76,657490.759 203796.179,657461.776 203726.723,657429.688 203651.264,657396.357 203571.354,657364.372 203495.584,657334.975 203425.818,657314.584 203383.689,657278.873 203321.79,657234.777 203247.987,657219.975 203222.834,657209.521 203203.995,657186.334 203166.317,657162.113 203125.637,657144.309 203097.483,657125.47 203071.605,657109.84 203052.559,657081.892 203021.713,657060.155 203001.011,657032.932 202978.135,656861.829 202848.747,656826.532 202822.144,656736.855 202754.561,656702.397 202728.423,656700.685 202727.124,656537.502 202605.844,656348.232 202461.619,656268.736 202401.376,656214.807 202360.696,656160.103 202318.369,656141.625 202301.385,656119.828 202273.558,656110.261 202259.256,656104.154 202249.526,656095.718 202233.016,656091.526 202223.39,656084.707 202207.83,656078.121 202192.802,656073.049 202179.553,656067.885 202162.471,656064.872 202150.259,656062.595 202131.213,656060.317 202115.946,656057.419 202087.791,656055.049 202068.911,656052.134 202034.579,656041.994 201945.915,656040.545 201935.771,656038.989 201922.461,656037.583 201910.042,656033.612 201877.457,656030.475 201853.604,656024.755 201824.036,656020.009 201797.043,656017.284 201772.675,656014.179 201745.11,656010.633 201717.578')
--	where GeometryType = 'Point'


--select * from @table order by Id